<!doctype html>
<html lang="en">
<head> <!-- ng-app="myApp" -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XXX</title>
    <!-- <link rel="stylesheet" href="css/pure-min.css"> -->
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.2.0/pure-min.css">
    <link rel="stylesheet" href="css/app.css"/>
    <script src="http://use.typekit.net/ajf8ggy.js"></script>
    <script>
      try { Typekit.load(); } catch (e) {}
    </script>    
    <script>
      // (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      // (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      // m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      // })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      // ga('create', 'UA-41480445-1', 'domain.com');
      // ga('send', 'pageview');
    </script>
</head>
<body>
  <div class="content pure-g-r">
    <div class="header pure-u-1">
        <div class="pure-menu pure-menu-open pure-menu-fixed pure-menu-horizontal">
            <!-- <a class="pure-menu-heading" href="/"><h1>PLAYEA</h1></a> -->
            <!-- <ul>
                <li class="pure-menu-selected"><a href="#">Home</a></li>
                <li><a href="#">Tour</a></li>
                <li><a href="#">API</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#/view1">view1</a></li>
                <li><a href="#/view2">view2</a></li>
            </ul> -->
            <form class="pure-form pure-g">     
              <div class="pure-u-3-4">
                <input type="email" placeholder="Type the name of the beach..." class="pure-input-1">
              </div>
              <div class="pure-u-1-4">
                <button type="submit" class="pure-button pure-button-primary pure-input-1">Search <i class="icon-search icon-large"></i></button>
              </div>
          </form>
        </div>
    </div>

    <div class="splash pure-u-1">
        <div class="pure-g-r">
            <div class="pure-u-1-3">
                <div class="l-box splash-image">
                    <img src="http://placehold.it/500x350"
                         alt="Placeholder image for example.">
                </div>
            </div>

            <div class="pure-u-2-3">
                <div class="l-box splash-text">
                    <h1 class="splash-head">
                        Playa de Punta Umbria.
                    </h1>

                    <!-- <th:fsq-login ng:show="!thFsq.logged" th:fsq-display="touch" th:fsq-color="black"></th:fsq-login>
                    <ul>
                      <li ng:repeat="photo in checkin.photos.items">
                        <a th:fsq-photo="photo" rel="lightbox[checkin]" title="{{ photo.user.firstName }}"><img th:fsq-photo="photo" th:fsq-photo-size="cap48"/></a>
                      </li>
                    </ul> -->
<form onsubmit="listAlbums(this.band.value); return false;">
<b>Enter the name of a band: </b>
<input type="text" name="band">
<input type="submit" value="List Albums">
</form>
<hr>
<!-- This is where we insert the results of our Metaweb queries -->
<h1 id="title"></h1>        <!-- display band name here -->
<div id="tracklist"></div>  <!-- list tracks here -->
<div id="albumlist"></div>  <!-- list of albums here -->
</div>

                    <h2 class="splash-subhead">
                      <!-- <div ng-view></div>
                      <div>Angular seed app: v<span app-version></span></div> -->
                      La playa de Punta Umbría es sin duda el espacio más identificativo y hermoso de esta ciudad. Una línea de costa interminable, de una belleza sobrecogedora, acompaña al visitante a lo largo de muchos kilómetros de relajante paseo.
                      Punta Umbría goza de 13 kilómetros de playas de arenas finas, doradas y limpias, que son su principal atractivo turístico.
                    </h2>
                    <!-- <p>
                        <a href="#" class="pure-button primary-button">Get Started</a>
                    </p> -->
                </div>
            </div>
        </div>
    </div>

    <div class="content pure-u-1">
        <!-- <div class="pure-g-r content-ribbon">
            <div class="pure-u-2-3">
                <div class="l-box">
                    <h4 class="content-subhead">Some small text</h4>

                    <h3>Lorem ipsum dolor sit amet.</h3>
                    <p>
                        Pellentesque hendrerit lobortis ornare. Fusce luctus imperdiet consequat. Nullam quis nunc quis ligula luctus vestibulum non quis libero. Suspendisse tristique nisl ut velit facilisis sit amet lobortis nulla pharetra.
                    </p>
                </div>
            </div>

            <div class="pure-u-1-3">
                <div class="l-box">
                    <img src="http://placehold.it/400x250"
                         alt="Placeholder image for example.">
                </div>
            </div>
        </div> -->

        <!-- <div class="pure-g-r content-ribbon">
            <div class="pure-u-1-3">
                <div class="l-box">
                    <img src="http://placehold.it/400x250"
                         alt="Placeholder image for example.">
                </div>
            </div>

            <div class="pure-u-2-3">
                <div class="l-box">
                    <h4 class="content-subhead">Some more small text</h4>

                    <h3>Etiam iaculis iaculis lobortis.</h3>
                    <p>
                        Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum. Morbi fermentum dui sit amet libero tincidunt rutrum. Nam sodales consequat metus sed accumsan.
                    </p>
                </div>
            </div>
        </div> -->

        <div class="pure-g-r">
            <div class="pure-u-1-4">
                <div class="l-box">
                    <h3>1st 4sq venue</h3>
                    <p>
                        Donec suscipit, risus vel venenatis ornare, nibh massa ultrices diam, a elementum metus felis sit amet eros. Phasellus pellentesque euismod massa sed pellentesque.
                    </p>
                </div>
            </div>

            <div class="pure-u-1-4">
                <div class="l-box">
                    <h3>2nd 4sq venue</h3>
                    <p>
                        Donec suscipit, risus vel venenatis ornare, nibh massa ultrices diam, a elementum metus felis sit amet eros. Phasellus pellentesque euismod massa sed pellentesque.
                    </p>
                </div>
            </div>

            <div class="pure-u-1-4">
                <div class="l-box">
                    <h3>3rd 4sq venue</h3>
                    <p>
                        Donec suscipit, risus vel venenatis ornare, nibh massa ultrices diam, a elementum metus felis sit amet eros. Phasellus pellentesque euismod massa sed pellentesque.
                    </p>
                </div>
            </div>

            <div class="pure-u-1-4">
                <div class="l-box">
                    <h3>4th 4sq venue</h3>
                    <p>
                        Donec suscipit, risus vel venenatis ornare, nibh massa ultrices diam, a elementum metus felis sit amet eros. Phasellus pellentesque euismod massa sed pellentesque.
                    </p>
                </div>
            </div>
        </div>

        <div class="pure-g-r">
            <div class="pure-u-1">
                <div class="l-box ribbon">
                    <h2>This venue has a 345 checkins</h2>
                    <!-- <a href="#" class="pure-button pure-button-secondary">Keep in touch</a> -->
                </div>
            </div>
        </div>
    </div>

    <div class="footer pure-u-1">
        A visualization app provided data from beaches in Spain. Made with love by the LEFTTT Team.
    </div>
  </div>

  <script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>
  <script type="text/javascript" src="js/json2.js"></script>
  <script type="text/javascript" src="js/metaweb.js"></script>

  <script src="http://yui.yahooapis.com/3.10.1/build/yui/yui-min.js"></script>
  <script>
    YUI().use('node-base', 'node-event-delegate', function (Y) {
    // This just makes sure that the href="#" attached to the <a> elements
    // don't scroll you back up the page.
    Y.one('.content').delegate('click', function (e) {
        e.preventDefault();
    }, 'a[href="#"]');
    });
  </script>

  <script type="text/javascript">
    query = [{'id': null, 'name': null, 'type': '/astronomy/planet'}];
   query_envelope = {'query' : query};
   service_url = 'http://api.freebase.com/api/service/mqlread';
   url = service_url  + '?callback=?&query=' + encodeURIComponent(JSON.stringify(query_envelope));
   $.getJSON(url, function(response) {
     $('body').append(response.result.map(function(planet){
       return planet.name;
     }).toString());
   });
  </script>

  <script type="text/javascript">                        
/* Display albums by the specified band */
function listAlbums(band) {
    // Find the document elements we need to insert content into
    var title = document.getElementById("title");
    var albumlist = document.getElementById("albumlist");
    var tracklist = document.getElementById("tracklist");

    title.innerHTML = "Albums by " + band;           // Set the page title 
    albumlist.innerHTML = "<b><i>Loading...</i></b>" // Album list is coming...
    tracklist.style.visibility = "hidden";           // Hide any old tracks
    
    var query = {                      // This is our MQL query 
  type: "/music/artist",         // Find a band
  name: band,                    // With the specified name
  album: [{                      // We want to know about albums         
      name:null,                 // Return album names
      id:null,                   // Also ids
      release_date:null,         // And release dates
      sort: "release_date",      // Order by release date
      "release_type!=":"single"  // Don't include singles
  }]
    };

    // Issue the query and invoke the function below when it is done
    Metaweb.read(query, displayAlbums);

    // This function is invoked when we get the result of our MQL query
    function displayAlbums(result) {
    console.log(result)  
  // If no result, the band was unknown.
  if (!result || !result.album) {
      albumlist.innerHTML = "<b><i>Unknown band: " + band + "</i></b>";
      return;
  }
  
  // Otherwise, the result object matches our query object, 
  // but has album data filled in.  
  var albums = result.album;  // the array of album data
  // Erase the "Loading..." message we displayed earlier
  albumlist.innerHTML = "";
  // Loop through the albums
  for(var i = 0; i < albums.length; i++) {
      var name = albums[i].name;                   // album name 
      var year = getYear(albums[i].release_date);  // album release year
      var text = name + (year?(" ["+year+"]"):""); // name+year

      // Create HTML elements to display the album name and year.
      var div = document.createElement("div");
      div.className = "album";
      div.appendChild(document.createTextNode(text));
      albumlist.appendChild(div);

      // Add an event handler to display tracks when an album is clicked
      div.onclick = makeHandler(name, albums[i].id);
  }

  // This function returns a function.  We do it this way to create
  // a closure that captures the band name and id.
  function makeHandler(name, id) {
      return function(e) { listTracks(name, id); }
  }
    }

    // A utility to return the year portion of a Metaweb /type/datetime
    function getYear(date) {
  if (!date) return null;
  if (date.length == 4) return date;
  if (date.match(/^\d{4}-/)) return date.substring(0,4);
  return null;
    }
}

/* Display the tracks on the specified album by the specified band */
function listTracks(albumname, albumid) {
    // Begin by displaying a Loading... message
    var tracklist = document.getElementById("tracklist");
    tracklist.innerHTML = "<h2>" + albumname + "</h2><p>Loading...";
    tracklist.style.visibility = "visible";

    // This is the MQL query we will issue
    var query = {
  type: "/music/album",
  id: albumid,
  // Get track names and lengths, sorted by index
  track: [{name:null, length:null, index:null, sort:"index"}]
    };

    // Issue the query, invoke the nested function when the response arrives
    Metaweb.read(query, function(result) {
         if (result && result.track) { // If result is defined
       var tracks = result.track;  // array of tracks
       // Build an array of track names + lengths
       var listitems = [];
       for(var i = 0; i < tracks.length; i++) {
           var n = tracks[i].name + " (" +
             toMinutesAndSeconds(tracks[i].length) + ")";
           listitems.push(n);
       }
       // Display the track list by setting innerHTML
       tracklist.innerHTML = "<h2>" + albumname + "</h2>" +
           "<ol><li>" + listitems.join("<li>") + "</ol>";
         }
         else {
       // If empty result display error message
       tracklist.innerHTML = "<h2>" + albumname + "</h2>" +
           "<p>No track list is available.";
         }
     });

    // Convert track length in seconds to minutes:seconds format
    function toMinutesAndSeconds(seconds) {
  var minutes = Math.floor(seconds/60);
  var seconds = Math.floor(seconds-(minutes*60));
  if (seconds <= 9) seconds = "0" + seconds;
  return minutes + ":" + seconds;
    }
};
  </script>

</body>
</html>

